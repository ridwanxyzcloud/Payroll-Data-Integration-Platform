{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-09-07T18:26:22.195450Z", "invocation_id": "316bf0f4-e460-4b3e-ab85-31a09397e940", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-07T18:26:15.590008Z", "completed_at": "2024-09-07T18:26:15.684136Z"}, {"name": "execute", "started_at": "2024-09-07T18:26:15.690841Z", "completed_at": "2024-09-07T18:26:20.202799Z"}], "thread_id": "Thread-1", "execution_time": 4.632555961608887, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS", "failures": null, "unique_id": "model.payrolldb.dim_agency", "compiled": true, "compiled_code": "WITH transformed AS (\n    SELECT DISTINCT\n        -- Directly cast and transform the source data\n        AgencyID::INT AS AgencyID,\n        INITCAP(AgencyName) AS AgencyName,\n        COALESCE(AgencyStartDate::DATE, '1900-01-01') AS AgencyStartDate\n    FROM \"payrolldb\".\"stg\".\"staging_dim_agency\"\n)\n\nSELECT\n    AgencyID,\n    AgencyName,\n    AgencyStartDate\nFROM transformed\n\n\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM \"payrolldb\".\"edw_edw\".\"dim_agency\"\n        WHERE AgencyID = transformed.AgencyID\n    )\n", "relation_name": "\"payrolldb\".\"edw_edw\".\"dim_agency\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-07T18:26:15.645360Z", "completed_at": "2024-09-07T18:26:15.700621Z"}, {"name": "execute", "started_at": "2024-09-07T18:26:15.775796Z", "completed_at": "2024-09-07T18:26:20.497408Z"}], "thread_id": "Thread-3", "execution_time": 4.9252028465271, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS", "failures": null, "unique_id": "model.payrolldb.dim_title", "compiled": true, "compiled_code": "-- models/warehouse/dim_title.sql\n\nWITH cleaned AS (\n    SELECT DISTINCT\n        TitleCode::INT AS TitleCode,\n        COALESCE(TitleDescription, '')::TEXT AS TitleDescription\n    FROM \"payrolldb\".\"stg\".\"staging_dim_title\"\n)\n\nSELECT\n    TitleCode,\n    TitleDescription\nFROM cleaned\n\n\n    WHERE TitleCode NOT IN (SELECT TitleCode FROM \"payrolldb\".\"edw_edw\".\"dim_title\")\n", "relation_name": "\"payrolldb\".\"edw_edw\".\"dim_title\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-07T18:26:15.603438Z", "completed_at": "2024-09-07T18:26:15.686917Z"}, {"name": "execute", "started_at": "2024-09-07T18:26:15.722902Z", "completed_at": "2024-09-07T18:26:20.500166Z"}], "thread_id": "Thread-2", "execution_time": 4.930688858032227, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS", "failures": null, "unique_id": "model.payrolldb.dim_employee", "compiled": true, "compiled_code": "-- models/warehouse/dim_employee.sql\n\nWITH cleaned AS (\n    SELECT\n        -- Initial cleaning and transformation\n        DISTINCT\n        EmployeeID::INT AS EmployeeID,\n        INITCAP(FirstName) AS FirstName,\n        INITCAP(LastName) AS LastName,\n        COALESCE(LeaveStatusasofJune30, '')::VARCHAR(10) AS LeaveStatusasofJune30\n    FROM \"payrolldb\".\"stg\".\"staging_dim_employee\"\n)\n\nSELECT\n    EmployeeID,\n    FirstName,\n    LastName,\n    LeaveStatusasofJune30\nFROM cleaned\n\n\n    WHERE EmployeeID NOT IN (SELECT EmployeeID FROM \"payrolldb\".\"edw_edw\".\"dim_employee\")\n", "relation_name": "\"payrolldb\".\"edw_edw\".\"dim_employee\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-07T18:26:15.663074Z", "completed_at": "2024-09-07T18:26:15.711747Z"}, {"name": "execute", "started_at": "2024-09-07T18:26:15.838883Z", "completed_at": "2024-09-07T18:26:20.502547Z"}], "thread_id": "Thread-4", "execution_time": 4.926973819732666, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4650}, "message": "SUCCESS", "failures": null, "unique_id": "model.payrolldb.fact_payroll", "compiled": true, "compiled_code": "WITH cleaned AS (\n    SELECT DISTINCT\n        -- Generate a pseudo-UUID as a VARCHAR\n        md5(random()::text || getdate()::text) AS PayrollID,  -- Using MD5 hash as UUID substitute\n        PayrollNumber::INT AS PayrollNumber,\n        EmployeeID::INT AS EmployeeID,\n        AgencyID::INT AS AgencyID,\n        TitleCode::INT AS TitleCode,\n        FiscalYear::INT AS FiscalYear,\n        BaseSalary::DECIMAL(10, 2) AS BaseSalary,\n        RegularHours::DECIMAL(10, 2) AS RegularHours,\n        RegularGrossPaid::DECIMAL(10, 2) AS RegularGrossPaid,\n        OTHours::DECIMAL(10, 2) AS OTHours,\n        TotalOTPaid::DECIMAL(10, 2) AS TotalOTPaid,\n        TotalOtherPay::DECIMAL(10, 2) AS TotalOtherPay,\n        WorkLocationBorough::VARCHAR(20) AS WorkLocationBorough\n    FROM \"payrolldb\".\"stg\".\"staging_fact_payroll\"\n    WHERE PayrollNumber IS NOT NULL  -- Filter out rows where essential fields are null\n),\n\nfiscal_year_lookup AS (\n    SELECT DateID, FiscalYear\n    FROM \"payrolldb\".\"edw\".\"dim_date\"\n)\n\nSELECT DISTINCT\n    c.PayrollID,\n    c.PayrollNumber,\n    c.EmployeeID,\n    c.AgencyID,\n    c.TitleCode,\n    fy.DateID AS DateID,\n    c.BaseSalary,\n    c.RegularHours,\n    c.RegularGrossPaid,\n    c.OTHours,\n    c.TotalOTPaid,\n    c.TotalOtherPay,\n    c.WorkLocationBorough\nFROM cleaned c\nLEFT JOIN fiscal_year_lookup fy\n    ON c.FiscalYear = fy.FiscalYear\n\n\n    WHERE NOT EXISTS (\n        SELECT 1\n        FROM \"payrolldb\".\"edw_edw\".\"fact_payroll\" AS existing\n        WHERE existing.PayrollID = c.PayrollID\n    )\n", "relation_name": "\"payrolldb\".\"edw_edw\".\"fact_payroll\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2024-09-07T18:26:20.231669Z", "completed_at": "2024-09-07T18:26:20.247658Z"}, {"name": "execute", "started_at": "2024-09-07T18:26:20.249522Z", "completed_at": "2024-09-07T18:26:21.414133Z"}], "thread_id": "Thread-1", "execution_time": 1.194526195526123, "adapter_response": {}, "message": "Database Error in model payroll_aggregate_by_agency (models/marts/payroll_aggregate_by_agency.sql)\n  syntax error at or near \"(\" in context \"(\n                  DBT_INTERNAL_SOURCE.(\", at line 17, column 37\n  compiled Code at target/run/payrolldb/models/marts/payroll_aggregate_by_agency.sql", "failures": null, "unique_id": "model.payrolldb.payroll_aggregate_by_agency", "compiled": true, "compiled_code": "WITH source_data AS (\n    SELECT\n        a.AgencyID,\n        a.AgencyName,\n        f.FiscalYear,\n        SUM(f.BaseSalary) AS TotalBaseSalary,\n        SUM(f.RegularGrossPaid) AS TotalRegularGrossPaid,\n        SUM(f.OTHours) AS TotalOTHours,\n        SUM(f.TotalOTPaid) AS TotalOTPaid,\n        SUM(f.TotalOtherPay) AS TotalOtherPay,\n        SUM(f.TotalOTPaid + f.TotalOtherPay) AS TotalSupplementalPay,\n        COUNT(DISTINCT f.EmployeeID) AS TotalEmployees\n    FROM\n        \"payrolldb\".\"stg\".\"staging_fact_payroll\" f  -- Aggregating directly from the source\n    JOIN\n        \"payrolldb\".\"stg\".\"staging_dim_agency\" a\n    ON\n        f.AgencyID = a.AgencyID\n    GROUP BY\n        a.AgencyID, a.AgencyName, f.FiscalYear\n)\n\nSELECT\n    AgencyID,\n    AgencyName,\n    FiscalYear,\n    TotalBaseSalary,\n    TotalRegularGrossPaid,\n    TotalOTHours,\n    TotalOTPaid,\n    TotalOtherPay,\n    TotalSupplementalPay,\n    TotalEmployees\nFROM source_data", "relation_name": "\"payrolldb\".\"edw_marts\".\"payroll_aggregate_by_agency\""}, {"status": "error", "timing": [{"name": "compile", "started_at": "2024-09-07T18:26:20.524468Z", "completed_at": "2024-09-07T18:26:20.533922Z"}, {"name": "execute", "started_at": "2024-09-07T18:26:20.536039Z", "completed_at": "2024-09-07T18:26:21.776323Z"}], "thread_id": "Thread-3", "execution_time": 1.271899700164795, "adapter_response": {}, "message": "Database Error in model overtime_by_employee_and_agency (models/marts/overtime_by_employee_and_agency.sql)\n  syntax error at or near \"(\" in context \"(\n                  DBT_INTERNAL_SOURCE.(\", at line 17, column 37\n  compiled Code at target/run/payrolldb/models/marts/overtime_by_employee_and_agency.sql", "failures": null, "unique_id": "model.payrolldb.overtime_by_employee_and_agency", "compiled": true, "compiled_code": "WITH source_data AS (\n    SELECT\n        EmployeeID,\n        AgencyID,\n        TitleCode,\n        SUM(OTHours) AS TotalOTHours,\n        SUM(TotalOTPaid) AS TotalOTPaid\n    FROM\n        \"payrolldb\".\"edw_edw\".\"fact_payroll\"\n    GROUP BY\n        EmployeeID, AgencyID, TitleCode\n)\n\nSELECT\n    EmployeeID,\n    AgencyID,\n    TitleCode,\n    TotalOTHours,\n    TotalOTPaid\nFROM source_data", "relation_name": "\"payrolldb\".\"edw_marts\".\"overtime_by_employee_and_agency\""}], "elapsed_time": 11.644105195999146, "args": {"use_colors": true, "version_check": true, "send_anonymous_usage_stats": true, "introspect": true, "empty": false, "vars": {}, "defer": false, "project_dir": "/Users/villy/PycharmProjects/Payroll-Data-Integration-Platform/dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "favor_state": false, "profiles_dir": ".", "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "quiet": false, "print": true, "write_json": true, "invocation_command": "dbt run --profiles-dir .", "select": [], "strict_mode": false, "log_path": "/Users/villy/PycharmProjects/Payroll-Data-Integration-Platform/dbt/logs", "partial_parse": true, "populate_cache": true, "log_level_file": "debug", "indirect_selection": "eager", "log_level": "info", "exclude": [], "partial_parse_file_diff": true, "printer_width": 80, "use_colors_file": true, "log_format": "default", "log_format_file": "debug", "log_file_max_bytes": 10485760, "macro_debugging": false, "cache_selected_only": false, "static_parser": true, "show_resource_report": false, "enable_legacy_logger": false, "which": "run", "source_freshness_run_project_hooks": false}}