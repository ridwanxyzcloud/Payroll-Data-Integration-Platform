2024-09-06 12:18:27,308 - root - INFO - Successfully created Redshift engine.
2024-09-06 12:18:27,309 - root - ERROR - ETL process failed: name 'table_schemas' is not defined
2024-09-06 12:40:50,169 - root - INFO - Successfully created Redshift engine.
2024-09-06 12:40:50,172 - root - ERROR - ETL process failed: name 'table_schemas' is not defined
2024-09-06 13:21:21,701 - root - INFO - Successfully created Redshift engine.
2024-09-06 13:21:21,717 - root - ERROR - Error processing file EmpMaster.csv: name 'extract_data' is not defined
2024-09-06 13:21:21,718 - root - ERROR - Error processing file TitleMaster.csv: name 'extract_data' is not defined
2024-09-06 13:21:21,718 - root - ERROR - Error processing file AgencyMaster.csv: name 'extract_data' is not defined
2024-09-06 13:21:21,718 - root - ERROR - ETL process failed: name 'logger' is not defined
2024-09-06 13:48:11,078 - root - INFO - Successfully created Redshift engine.
2024-09-06 13:48:11,084 - root - ERROR - Error processing file EmpMaster.csv: name 's3_client' is not defined
2024-09-06 13:48:11,085 - root - ERROR - Error processing file TitleMaster.csv: name 's3_client' is not defined
2024-09-06 13:48:11,085 - root - ERROR - Error processing file AgencyMaster.csv: name 's3_client' is not defined
2024-09-06 13:48:11,087 - root - ERROR - Error staging data: name 'engine' is not defined
2024-09-06 13:48:11,098 - root - ERROR - Error processing file nycpayroll_2021.csv: name 's3_client' is not defined
2024-09-06 13:48:11,099 - root - ERROR - Error processing file nycpayroll_2020.csv: name 's3_client' is not defined
2024-09-06 13:48:11,099 - root - ERROR - Error staging data: name 'engine' is not defined
2024-09-06 13:48:11,100 - root - ERROR - ETL process failed: [Errno 2] No such file or directory: '/opt/airflow/dbt'
2024-09-06 14:22:18,398 - root - INFO - Successfully created Redshift engine.
2024-09-06 14:22:18,407 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 14:22:18,628 - root - INFO - Validating and cleaning master data
2024-09-06 14:22:18,675 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in EmployeeID to NaN.; Standardized FirstName to title case.; Standardized LastName to title case.
2024-09-06 14:22:18,708 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 14:22:18,767 - root - INFO - Validating and cleaning master data
2024-09-06 14:22:18,770 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in TitleCode to NaN.
2024-09-06 14:22:18,776 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 14:22:18,836 - root - INFO - Validating and cleaning master data
2024-09-06 14:22:18,842 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in AgencyID to NaN.
2024-09-06 14:23:45,799 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 14:23:58,913 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 14:25:26,213 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 14:25:26,215 - root - INFO - Master data successfully transformed and staged.
2024-09-06 14:25:26,216 - root - INFO -  - dim_employee: 1000 rows
2024-09-06 14:25:26,216 - root - INFO -  - dim_agency: 153 rows
2024-09-06 14:25:26,216 - root - INFO -  - dim_title: 1446 rows
2024-09-06 14:25:26,217 - root - INFO - Total master data staged: 2599 rows
2024-09-06 14:25:26,226 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 14:25:26,422 - root - INFO - Validating and cleaning transactional data
2024-09-06 14:25:26,531 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in OTHours with their positive equivalents.; Replaced negative values in TotalOTPaid with their positive equivalents.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 14:25:26,554 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 14:25:26,610 - root - INFO - Validating and cleaning transactional data
2024-09-06 14:25:26,663 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 14:25:42,334 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 14:25:56,230 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 14:25:59,333 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 14:26:26,480 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 14:26:26,482 - root - ERROR - ETL process failed: name 'total_master_rows' is not defined
2024-09-06 18:03:28,839 - root - ERROR - ETL process failed: [Errno 48] Address already in use
2024-09-06 18:12:55,121 - root - ERROR - Port 8001 is already in use. Cannot start Prometheus metrics server.
2024-09-06 18:12:56,402 - root - INFO - Successfully created Redshift engine.
2024-09-06 18:12:56,407 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 18:12:56,688 - root - ERROR - Failed to extract EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:12:56,688 - root - ERROR - Error processing file EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:12:56,688 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 18:12:56,790 - root - ERROR - Failed to extract TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:12:56,790 - root - ERROR - Error processing file TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:12:56,791 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 18:12:56,837 - root - ERROR - Failed to extract AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:12:56,838 - root - ERROR - Error processing file AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:13:16,111 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:13:16,172 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:13:16,244 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:13:16,244 - root - INFO - Master data successfully transformed and staged.
2024-09-06 18:13:16,244 - root - INFO -  - dim_employee: 0 rows
2024-09-06 18:13:16,244 - root - INFO -  - dim_agency: 0 rows
2024-09-06 18:13:16,245 - root - INFO -  - dim_title: 0 rows
2024-09-06 18:13:16,245 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 18:13:16,253 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 18:13:16,426 - root - ERROR - Failed to extract nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:13:16,426 - root - ERROR - Error processing file nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:13:16,426 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 18:13:16,499 - root - ERROR - Failed to extract nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:13:16,499 - root - ERROR - Error processing file nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:13:16,576 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:13:16,640 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:13:16,728 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:13:16,822 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 18:13:16,823 - root - ERROR - ETL process failed: name 'total_master_rows_staged' is not defined
2024-09-06 18:22:52,968 - root - ERROR - Port 8001 is already in use. Cannot start Prometheus metrics server.
2024-09-06 18:22:54,171 - root - INFO - Successfully created Redshift engine.
2024-09-06 18:22:54,183 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 18:22:54,386 - root - ERROR - Failed to extract EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:22:54,386 - root - ERROR - Error processing file EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:22:54,387 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 18:22:54,444 - root - ERROR - Failed to extract TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:22:54,445 - root - ERROR - Error processing file TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:22:54,446 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 18:22:54,497 - root - ERROR - Failed to extract AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:22:54,497 - root - ERROR - Error processing file AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:22:55,989 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:22:56,061 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:22:56,153 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:22:56,154 - root - INFO - Master data successfully transformed and staged.
2024-09-06 18:22:56,154 - root - INFO -  - dim_employee: 0 rows
2024-09-06 18:22:56,155 - root - INFO -  - dim_agency: 0 rows
2024-09-06 18:22:56,155 - root - INFO -  - dim_title: 0 rows
2024-09-06 18:22:56,155 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 18:22:56,165 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 18:22:56,224 - root - ERROR - Failed to extract nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:22:56,224 - root - ERROR - Error processing file nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:22:56,225 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 18:22:56,281 - root - ERROR - Failed to extract nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:22:56,282 - root - ERROR - Error processing file nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:22:56,353 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:22:56,453 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:22:56,529 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:22:56,616 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 18:22:56,616 - root - ERROR - ETL process failed: name 'total_master_rows_staged' is not defined
2024-09-06 18:25:33,598 - root - ERROR - Port 8001 is already in use. Cannot start Prometheus metrics server.
2024-09-06 18:25:34,646 - root - INFO - Successfully created Redshift engine.
2024-09-06 18:25:34,654 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 18:25:34,945 - root - INFO - Validating and cleaning master data
2024-09-06 18:25:34,963 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in EmployeeID to NaN.; Standardized FirstName to title case.; Standardized LastName to title case.
2024-09-06 18:25:34,980 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 18:25:35,048 - root - INFO - Validating and cleaning master data
2024-09-06 18:25:35,050 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in TitleCode to NaN.
2024-09-06 18:25:35,056 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 18:25:35,097 - root - INFO - Validating and cleaning master data
2024-09-06 18:25:35,100 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in AgencyID to NaN.
2024-09-06 18:26:38,906 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:26:48,684 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:28:18,667 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:28:18,668 - root - INFO - Master data successfully transformed and staged.
2024-09-06 18:28:18,668 - root - INFO -  - dim_employee: 1000 rows
2024-09-06 18:28:18,668 - root - INFO -  - dim_agency: 153 rows
2024-09-06 18:28:18,669 - root - INFO -  - dim_title: 1446 rows
2024-09-06 18:28:18,669 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 18:28:18,691 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 18:28:18,891 - root - INFO - Validating and cleaning transactional data
2024-09-06 18:28:18,892 - root - ERROR - Error processing file nycpayroll_2021.csv: local variable 'total_transactional_rows_validated' referenced before assignment
2024-09-06 18:28:18,892 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 18:28:18,969 - root - INFO - Validating and cleaning transactional data
2024-09-06 18:28:18,970 - root - ERROR - Error processing file nycpayroll_2020.csv: local variable 'total_transactional_rows_validated' referenced before assignment
2024-09-06 18:28:19,042 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:28:19,116 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:28:19,186 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:28:19,261 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 18:28:19,261 - root - ERROR - ETL process failed: name 'total_master_rows_staged' is not defined
2024-09-06 18:32:05,592 - root - ERROR - Port 8001 is already in use. Cannot start Prometheus metrics server.
2024-09-06 18:32:07,006 - root - INFO - Successfully created Redshift engine.
2024-09-06 18:32:07,015 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 18:32:07,225 - root - ERROR - Failed to extract EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:32:07,226 - root - ERROR - Error processing file EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:32:07,226 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 18:32:07,311 - root - ERROR - Failed to extract TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:32:07,311 - root - ERROR - Error processing file TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:32:07,312 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 18:32:07,378 - root - ERROR - Failed to extract AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:32:07,379 - root - ERROR - Error processing file AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:32:07,892 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:32:07,948 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:32:08,019 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:32:08,019 - root - INFO - Master data successfully transformed and staged.
2024-09-06 18:32:08,020 - root - INFO -  - dim_employee: 0 rows
2024-09-06 18:32:08,020 - root - INFO -  - dim_agency: 0 rows
2024-09-06 18:32:08,021 - root - INFO -  - dim_title: 0 rows
2024-09-06 18:32:08,021 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 18:32:08,203 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 18:32:08,324 - root - ERROR - Failed to extract nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:32:08,325 - root - ERROR - Error processing file nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:32:08,325 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 18:32:08,400 - root - ERROR - Failed to extract nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:32:08,401 - root - ERROR - Error processing file nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:32:08,475 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:32:08,569 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:32:08,638 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:32:08,727 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 18:32:08,728 - root - ERROR - ETL process failed: name 'total_master_rows_staged' is not defined
2024-09-06 18:52:19,093 - root - ERROR - Port 8001 is already in use. Cannot start Prometheus metrics server.
2024-09-06 18:52:20,395 - root - INFO - Successfully created Redshift engine.
2024-09-06 18:52:20,500 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 18:52:20,846 - root - ERROR - Failed to extract EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:52:20,847 - root - ERROR - Error processing file EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:52:20,847 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 18:52:20,921 - root - ERROR - Failed to extract TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:52:20,922 - root - ERROR - Error processing file TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:52:20,922 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 18:52:21,010 - root - ERROR - Failed to extract AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:52:21,010 - root - ERROR - Error processing file AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:52:22,509 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:52:22,570 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:52:22,629 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:52:22,629 - root - INFO - Master data successfully transformed and staged.
2024-09-06 18:52:22,629 - root - INFO -  - dim_employee: 0 rows
2024-09-06 18:52:22,629 - root - INFO -  - dim_agency: 0 rows
2024-09-06 18:52:22,630 - root - INFO -  - dim_title: 0 rows
2024-09-06 18:52:22,630 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 18:52:22,634 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 18:52:22,703 - root - ERROR - Failed to extract nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:52:22,703 - root - ERROR - Error processing file nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:52:22,703 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 18:52:22,756 - root - ERROR - Failed to extract nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:52:22,756 - root - ERROR - Error processing file nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:52:22,823 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:52:22,885 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:52:22,954 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:52:23,028 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 18:52:23,028 - root - ERROR - ETL process failed: name 'total_master_rows_staged' is not defined
2024-09-06 18:58:54,140 - root - INFO - Prometheus metrics server started on port 8001
2024-09-06 18:58:55,266 - root - INFO - Successfully created Redshift engine.
2024-09-06 18:58:55,274 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 18:58:55,484 - root - ERROR - Failed to extract EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:58:55,484 - root - ERROR - Error processing file EmpMaster.csv: name 'master_files' is not defined
2024-09-06 18:58:55,484 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 18:58:55,562 - root - ERROR - Failed to extract TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:58:55,562 - root - ERROR - Error processing file TitleMaster.csv: name 'master_files' is not defined
2024-09-06 18:58:55,563 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 18:58:55,615 - root - ERROR - Failed to extract AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:58:55,616 - root - ERROR - Error processing file AgencyMaster.csv: name 'master_files' is not defined
2024-09-06 18:58:56,214 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:58:56,343 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:58:56,404 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:58:56,404 - root - INFO - Master data successfully transformed and staged.
2024-09-06 18:58:56,405 - root - INFO -  - dim_employee: 0 rows
2024-09-06 18:58:56,405 - root - INFO -  - dim_agency: 0 rows
2024-09-06 18:58:56,405 - root - INFO -  - dim_title: 0 rows
2024-09-06 18:58:56,406 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 18:58:56,413 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 18:58:56,470 - root - ERROR - Failed to extract nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:58:56,470 - root - ERROR - Error processing file nycpayroll_2021.csv: name 'master_files' is not defined
2024-09-06 18:58:56,471 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 18:58:56,526 - root - ERROR - Failed to extract nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:58:56,526 - root - ERROR - Error processing file nycpayroll_2020.csv: name 'master_files' is not defined
2024-09-06 18:58:56,598 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 18:58:56,670 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 18:58:56,736 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 18:58:56,821 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 18:58:56,821 - root - ERROR - ETL process failed: name 'total_master_rows_staged' is not defined
2024-09-06 19:13:13,419 - root - INFO - Prometheus metrics server started on port 8001
2024-09-06 19:13:14,756 - root - INFO - Successfully created Redshift engine.
2024-09-06 19:13:14,760 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 19:13:14,948 - root - INFO - Validating and cleaning master data
2024-09-06 19:13:14,956 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in EmployeeID to NaN.; Standardized FirstName to title case.; Standardized LastName to title case.
2024-09-06 19:13:15,012 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 19:13:15,106 - root - INFO - Validating and cleaning master data
2024-09-06 19:13:15,110 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in TitleCode to NaN.
2024-09-06 19:13:15,118 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 19:13:15,195 - root - INFO - Validating and cleaning master data
2024-09-06 19:13:15,200 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in AgencyID to NaN.
2024-09-06 19:14:19,365 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 19:14:29,097 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 19:15:52,774 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 19:15:52,774 - root - INFO - Master data successfully transformed and staged.
2024-09-06 19:15:52,774 - root - INFO -  - dim_employee: 1000 rows
2024-09-06 19:15:52,774 - root - INFO -  - dim_agency: 153 rows
2024-09-06 19:15:52,775 - root - INFO -  - dim_title: 1446 rows
2024-09-06 19:15:52,775 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 19:15:52,779 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 19:15:52,980 - root - INFO - Validating and cleaning transactional data
2024-09-06 19:15:52,981 - root - ERROR - Error processing file nycpayroll_2021.csv: local variable 'total_transactional_rows_validated' referenced before assignment
2024-09-06 19:15:52,981 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 19:15:53,036 - root - INFO - Validating and cleaning transactional data
2024-09-06 19:15:53,037 - root - ERROR - Error processing file nycpayroll_2020.csv: local variable 'total_transactional_rows_validated' referenced before assignment
2024-09-06 19:15:53,108 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 19:15:53,167 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 19:15:53,231 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 19:15:53,300 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 19:15:53,300 - root - ERROR - ETL process failed: unsupported operand type(s) for +: 'NoneType' and 'int'
2024-09-06 21:36:48,818 - root - INFO - Prometheus metrics server started on port 8001
2024-09-06 21:36:50,849 - root - INFO - Successfully created Redshift engine.
2024-09-06 21:36:50,855 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 21:36:51,009 - root - INFO - Validating and cleaning master data
2024-09-06 21:36:51,018 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in EmployeeID to NaN.; Standardized FirstName to title case.; Standardized LastName to title case.
2024-09-06 21:36:51,031 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 21:36:51,124 - root - INFO - Validating and cleaning master data
2024-09-06 21:36:51,128 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in TitleCode to NaN.
2024-09-06 21:36:51,143 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 21:36:51,198 - root - INFO - Validating and cleaning master data
2024-09-06 21:36:51,201 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in AgencyID to NaN.
2024-09-06 21:38:11,165 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 21:38:20,678 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 21:39:44,643 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 21:39:44,644 - root - INFO - Master data successfully transformed and staged.
2024-09-06 21:39:44,644 - root - INFO -  - dim_employee: 1000 rows
2024-09-06 21:39:44,645 - root - INFO -  - dim_agency: 153 rows
2024-09-06 21:39:44,645 - root - INFO -  - dim_title: 1446 rows
2024-09-06 21:39:44,646 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 21:39:44,656 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 21:39:44,852 - root - INFO - Validating and cleaning transactional data
2024-09-06 21:39:44,960 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in OTHours with their positive equivalents.; Replaced negative values in TotalOTPaid with their positive equivalents.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 21:39:44,988 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 21:39:45,061 - root - INFO - Validating and cleaning transactional data
2024-09-06 21:39:45,140 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 21:39:57,340 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 21:40:08,744 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 21:40:11,781 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 21:40:26,216 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 21:40:26,216 - root - ERROR - ETL process failed: unsupported operand type(s) for +: 'NoneType' and 'int'
2024-09-06 22:20:22,436 - root - ERROR - Port 8001 is already in use. Cannot start Prometheus metrics server.
2024-09-06 22:20:23,512 - root - INFO - Successfully created Redshift engine.
2024-09-06 22:20:23,516 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 22:20:23,692 - root - INFO - Validating and cleaning master data
2024-09-06 22:20:23,697 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in EmployeeID to NaN.; Standardized FirstName to title case.; Standardized LastName to title case.
2024-09-06 22:20:23,708 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 22:20:23,784 - root - INFO - Validating and cleaning master data
2024-09-06 22:20:23,788 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in TitleCode to NaN.
2024-09-06 22:20:23,794 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 22:20:23,857 - root - INFO - Validating and cleaning master data
2024-09-06 22:20:23,862 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in AgencyID to NaN.
2024-09-06 22:21:21,382 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 22:21:30,297 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 22:22:50,634 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 22:22:50,635 - root - INFO - Master data successfully transformed and staged.
2024-09-06 22:22:50,635 - root - INFO -  - dim_employee: 1000 rows
2024-09-06 22:22:50,636 - root - INFO -  - dim_agency: 153 rows
2024-09-06 22:22:50,637 - root - INFO -  - dim_title: 1446 rows
2024-09-06 22:22:50,637 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 22:22:50,649 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 22:22:50,834 - root - INFO - Validating and cleaning transactional data
2024-09-06 22:22:50,903 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in OTHours with their positive equivalents.; Replaced negative values in TotalOTPaid with their positive equivalents.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 22:22:50,928 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 22:22:50,970 - root - INFO - Validating and cleaning transactional data
2024-09-06 22:22:51,062 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 22:23:02,960 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 22:23:13,722 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 22:23:16,374 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 22:23:29,788 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 22:23:29,789 - root - INFO - Transactional data successfully transformed and staged.
2024-09-06 22:23:29,789 - root - INFO -  - fact_payroll: 201 rows
2024-09-06 22:23:29,789 - root - INFO - Total transactional data staged: 201 rows
2024-09-06 22:23:29,790 - root - INFO - All data successfully transformed and staged.
2024-09-06 22:23:29,790 - root - ERROR - ETL process failed: [Errno 2] No such file or directory: '/opt/airflow/dbt'
2024-09-06 22:26:24,463 - root - INFO - Prometheus metrics server started on port 8001
2024-09-06 22:26:25,173 - root - INFO - Successfully created Redshift engine.
2024-09-06 22:26:25,177 - root - INFO - Extracting EmpMaster.csv from S3
2024-09-06 22:26:25,353 - root - INFO - Validating and cleaning master data
2024-09-06 22:26:25,361 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in EmployeeID to NaN.; Standardized FirstName to title case.; Standardized LastName to title case.
2024-09-06 22:26:25,373 - root - INFO - Extracting TitleMaster.csv from S3
2024-09-06 22:26:25,465 - root - INFO - Validating and cleaning master data
2024-09-06 22:26:25,467 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in TitleCode to NaN.
2024-09-06 22:26:25,476 - root - INFO - Extracting AgencyMaster.csv from S3
2024-09-06 22:26:25,544 - root - INFO - Validating and cleaning master data
2024-09-06 22:26:25,550 - root - INFO - Master Data Cleaning Summary: Converted non-numeric values in AgencyID to NaN.
2024-09-06 22:27:25,197 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 22:27:34,517 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 22:28:55,615 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 22:28:55,616 - root - INFO - Master data successfully transformed and staged.
2024-09-06 22:28:55,616 - root - INFO -  - dim_employee: 1000 rows
2024-09-06 22:28:55,616 - root - INFO -  - dim_agency: 153 rows
2024-09-06 22:28:55,616 - root - INFO -  - dim_title: 1446 rows
2024-09-06 22:28:55,617 - root - INFO - Total master data staged: gauge:total_master_rows_ingested rows
2024-09-06 22:28:55,630 - root - INFO - Extracting nycpayroll_2021.csv from S3
2024-09-06 22:28:55,793 - root - INFO - Validating and cleaning transactional data
2024-09-06 22:28:55,868 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in OTHours with their positive equivalents.; Replaced negative values in TotalOTPaid with their positive equivalents.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 22:28:55,893 - root - INFO - Extracting nycpayroll_2020.csv from S3
2024-09-06 22:28:55,935 - root - INFO - Validating and cleaning transactional data
2024-09-06 22:28:56,005 - root - INFO - Transactional Data Cleaning Summary: Dropped rows with missing values in FiscalYear as it was <= 5%; Dropped rows with missing values in PayrollNumber as it was <= 5%; Dropped rows with missing values in AgencyID as it was <= 5%; Dropped rows with missing values in AgencyName as it was <= 5%; Dropped rows with missing values in EmployeeID as it was <= 5%; Dropped rows with missing values in LastName as it was <= 5%; Dropped rows with missing values in FirstName as it was <= 5%; Dropped rows with missing values in AgencyStartDate as it was <= 5%; Dropped rows with missing values in WorkLocationBorough as it was <= 5%; Dropped rows with missing values in TitleCode as it was <= 5%; Dropped rows with missing values in TitleDescription as it was <= 5%; Dropped rows with missing values in LeaveStatusasofJune30 as it was <= 5%; Dropped rows with missing values in BaseSalary as it was <= 5%; Dropped rows with missing values in PayBasis as it was <= 5%; Dropped rows with missing values in RegularHours as it was <= 5%; Dropped rows with missing values in RegularGrossPaid as it was <= 5%; Dropped rows with missing values in OTHours as it was <= 5%; Dropped rows with missing values in TotalOTPaid as it was <= 5%; Dropped rows with missing values in TotalOtherPay as it was <= 5%; Converted non-numeric values in EmployeeID to NaN.; Converted non-numeric values in TitleCode to NaN.; Converted non-numeric values in AgencyID to NaN.; Converted non-numeric values in PayrollNumber to NaN.; Replaced negative values in TotalOtherPay with their positive equivalents.; Standardized FirstName to title case.; Standardized LastName to title case.; Standardized PayBasis to uppercase.; Standardized WorkLocationBorough to uppercase.; Standardized AgencyStartDate to datetime format.
2024-09-06 22:29:08,211 - root - INFO - Data successfully staged to staging_dim_employee.
2024-09-06 22:29:19,061 - root - INFO - Data successfully staged to staging_dim_agency.
2024-09-06 22:29:21,723 - root - INFO - Data successfully staged to staging_dim_title.
2024-09-06 22:29:35,447 - root - INFO - Data successfully staged to staging_fact_payroll.
2024-09-06 22:29:35,447 - root - INFO - Transactional data successfully transformed and staged.
2024-09-06 22:29:35,448 - root - INFO -  - fact_payroll: 201 rows
2024-09-06 22:29:35,448 - root - INFO - Total transactional data staged: 201 rows
2024-09-06 22:29:35,448 - root - INFO - All data successfully transformed and staged.
2024-09-06 22:29:35,449 - root - ERROR - ETL process failed: [Errno 2] No such file or directory: '/opt/airflow/dbt'
